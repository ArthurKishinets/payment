var app=angular.module("neolent",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/user"),e.state("payment",{url:"/payment",templateUrl:"../views/payment.html"}).state("alterPayment",{url:"/payments/:id",templateUrl:"../views/paymentsAlter.html",controller:"paymentAlter"}).state("user",{url:"/user",templateUrl:"../views/userAlter.html",controller:"userAlter"})}]);
app.directive("paymentsTable",["$compile","$rootScope","payment","$location",function(e,t,n,a){return{replace:!0,restrict:"EACM",templateUrl:"../views/paymentTable.html",link:function(e,t,o){for(var l=n.getPayments(),m=0,r=0;r<l.length;r++)m+=l[r].amount;console.log(l.length),e.sumPayments=m,e.amountPay=l.length,e.alterPay=function(e){console.log(e);var e=n.getPaymentById(e),t="/payments/"+e.id;a.path(t)}}}}]);
app.directive("mysearch",["payment",function(e){return{retrict:"EACM",link:function(e,t,n){console.log("search ------------"),console.log(e.payments),e.myOptions=e.payments},templateUrl:"../views/search.html"}}]);
app.controller("mainController",["user","$rootScope","$scope","payment","$timeout",function(e,n,t,s,o){e.getUsers(),e.newUser(),n.currentUser=e.currentUser(),t.payments=s.getPayments(),t.newPayment=s.newPayment,t.formSubmit=function(e,n){t.newPayment(e,n),t.showPayMessage(),t.payments=s.getPayments(),console.log(this.cause),this.cause=this.amount=""},t.showPayMessage=function(){t.showSM=!0,o(function(){t.showSM=!1},2e3)}}]);
app.controller("paymentAlter",["$stateParams","$scope","payment",function(e,t,a){t.id=e.id,t.alterPay=function(e,n){console.log(e),console.log(n),a.alterPayment(t.id,e,n),t.alterCause=t.alterNumber="",t.$parent.payments=a.getPayments()}}]);
app.controller("userAlter",["$scope","user","$rootScope",function(e,r,o){e.user=r.currentUser(),console.log("userAlter"),e.changeName=function(c,n){r.changeName(c,n),e.user=r.currentUser(),o.currentUser=r.currentUser(),console.log(e.user)}}]);
app.factory("user",function(){function r(){return a}function e(){var r={};users=s(),r.id=r.name=users.length,users.push(r),a=r,localStorage.users=JSON.stringify(users)}function s(){if(void 0==localStorage.users)var r=[];else var r=JSON.parse(localStorage.users);return r}function n(r,e){for(var n=s(),t=0;t<n.length;t++)n[t].id==r&&(n[t].name=e,a=n[t]);localStorage.users=JSON.stringify(n)}var a;return{newUser:e,getUsers:s,currentUser:r,changeName:n}});
app.factory("payment",["$rootScope",function(e){function o(o,t){var a={},r=n();a.amount=o,a.cause=t,a.id=r.length,a.creator=e.currentUser,r.push(a),console.log("payment created!"),console.log(r),localStorage.payments=JSON.stringify(r)}function n(){if(void 0==localStorage.payments)var e=[];else var e=JSON.parse(localStorage.payments);return console.log("returned value"),console.log(e),e}function t(e){for(var o,t=n(),a=0;a<t.length;a++)t[a].id==e&&(o=t[a]);return o}function a(e,o,t){for(var a=n(),r=0;r<a.length;r++)a[r].id==e&&(a[r].amount=o,a[r].cause=t);localStorage.payments=JSON.stringify(a),console.log("ALTERED PAYMENT"),console.log(a)}return{getPayments:n,newPayment:o,getPaymentById:t,alterPayment:a}}]);